/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/@tiptap/extension-link@2.0.0-beta.220/dist/index.umd.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@tiptap/core"),require("linkifyjs"),require("@tiptap/pm/state")):"function"==typeof define&&define.amd?define(["exports","@tiptap/core","linkifyjs","@tiptap/pm/state"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self)["@tiptap/extension-link"]={},t.core,t.linkifyjs,t.state)}(this,(function(t,e,n,i){"use strict";const o=e.Mark.create({name:"link",priority:1e3,keepOnSplit:!1,onCreate(){this.options.protocols.forEach((t=>{"string"!=typeof t?n.registerCustomProtocol(t.scheme,t.optionalSlashes):n.registerCustomProtocol(t)}))},onDestroy(){n.reset()},inclusive(){return this.options.autolink},addOptions:()=>({openOnClick:!0,linkOnPaste:!0,autolink:!0,protocols:[],HTMLAttributes:{target:"_blank",rel:"noopener noreferrer nofollow",class:null},validate:void 0}),addAttributes(){return{href:{default:null},target:{default:this.options.HTMLAttributes.target},class:{default:this.options.HTMLAttributes.class}}},parseHTML:()=>[{tag:'a[href]:not([href *= "javascript:" i])'}],renderHTML({HTMLAttributes:t}){return["a",e.mergeAttributes(this.options.HTMLAttributes,t),0]},addCommands(){return{setLink:t=>({chain:e})=>e().setMark(this.name,t).setMeta("preventAutolink",!0).run(),toggleLink:t=>({chain:e})=>e().toggleMark(this.name,t,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run(),unsetLink:()=>({chain:t})=>t().unsetMark(this.name,{extendEmptyMarkRange:!0}).setMeta("preventAutolink",!0).run()}},addPasteRules(){return[e.markPasteRule({find:t=>n.find(t).filter((t=>!this.options.validate||this.options.validate(t.value))).filter((t=>t.isLink)).map((t=>({text:t.value,index:t.start,data:t}))),type:this.type,getAttributes:t=>{var e;return{href:null===(e=t.data)||void 0===e?void 0:e.href}}})]},addProseMirrorPlugins(){const t=[];var o;return this.options.autolink&&t.push((o={type:this.type,validate:this.options.validate},new i.Plugin({key:new i.PluginKey("autolink"),appendTransaction:(t,i,r)=>{const s=t.some((t=>t.docChanged))&&!i.doc.eq(r.doc),a=t.some((t=>t.getMeta("preventAutolink")));if(!s||a)return;const{tr:l}=r,d=e.combineTransactionSteps(i.doc,[...t]),{mapping:p}=d;return e.getChangedRanges(d).forEach((({oldRange:t,newRange:s})=>{e.getMarksBetween(t.from,t.to,i.doc).filter((t=>t.mark.type===o.type)).forEach((t=>{const s=p.map(t.from),a=p.map(t.to),d=e.getMarksBetween(s,a,r.doc).filter((t=>t.mark.type===o.type));if(!d.length)return;const u=d[0],f=i.doc.textBetween(t.from,t.to,void 0," "),c=r.doc.textBetween(u.from,u.to,void 0," "),h=n.test(f),k=n.test(c);h&&!k&&l.removeMark(u.from,u.to,o.type)}));const a=e.findChildrenInRange(r.doc,s,(t=>t.isTextblock));let d,u;if(a.length>1?(d=a[0],u=r.doc.textBetween(d.pos,d.pos+d.node.nodeSize,void 0," ")):a.length&&r.doc.textBetween(s.from,s.to," "," ").endsWith(" ")&&(d=a[0],u=r.doc.textBetween(d.pos,s.to,void 0," ")),d&&u){const t=u.split(" ").filter((t=>""!==t));if(t.length<=0)return!1;const e=t[t.length-1],i=d.pos+u.lastIndexOf(e);if(!e)return!1;n.find(e).filter((t=>t.isLink)).filter((t=>!o.validate||o.validate(t.value))).map((t=>({...t,from:i+t.start+1,to:i+t.end+1}))).forEach((t=>{l.addMark(t.from,t.to,o.type.create({href:t.href}))}))}})),l.steps.length?l:void 0}}))),this.options.openOnClick&&t.push(function(t){return new i.Plugin({key:new i.PluginKey("handleClickLink"),props:{handleClick:(n,i,o)=>{var r,s,a;const l=e.getAttributes(n.state,t.type.name),d=null===(r=o.target)||void 0===r?void 0:r.closest("a"),p=null!==(s=null==d?void 0:d.href)&&void 0!==s?s:l.href,u=null!==(a=null==d?void 0:d.target)&&void 0!==a?a:l.target;return!(!d||!p||(window.open(p,u),0))}}})}({type:this.type})),this.options.linkOnPaste&&t.push(function(t){return new i.Plugin({key:new i.PluginKey("handlePasteLink"),props:{handlePaste:(e,i,o)=>{const{state:r}=e,{selection:s}=r,{empty:a}=s;if(a)return!1;let l="";o.content.forEach((t=>{l+=t.textContent}));const d=n.find(l).find((t=>t.isLink&&t.value===l));return!(!l||!d||(t.editor.commands.setMark(t.type,{href:d.href}),0))}}})}({editor:this.editor,type:this.type})),t}});t.Link=o,t.default=o,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=/sm/72c03e882aeaf3a062d48b2e55d2d2ccadb251387387d28d6267e95442fce211.map